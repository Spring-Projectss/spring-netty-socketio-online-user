<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
<title>Admin Page | Spring</title>
</head>
<body>
	<h3>Hello, <span th:text="${#authentication.name}"></span></h3>
	<span id="userId" th:text="${#authentication.principal.id}"></span>
	<ul></ul>
	
	<input type="text" id="message" placeholder="message here...">
	<button>Send</button>
	
	<script src="/static/js/socket.io/socket.io.js"></script>
    <script src="/static/js/jquery-1.7.2.min.js"></script>
    <script>
    
	    var server = "http://192.168.43.192:3000";
		var socket =  io.connect(server);

    	socket.on('connect', function(){
			console.log('connected to server', socket.id);
			socket.emit('login', $('#userId').text());
		});   
		
		socket.on('online-users', function(data){
			console.log(data);
			var html = ``;
			data.forEach(function(user){
				html += `<li>${user.username}</li>`;
			});
			$('ul').html(html);
		});
		
		$('button').on('click', function(){
			socket.emit('chat', $('#message').val());
		});
		
		
		socket.on('message', function(data){
			console.log(data);
		});
		
    </script>
</body>
</html>